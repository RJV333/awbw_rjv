<%= form_with url: workshop_logs_path,
              method: :get,
              local: true,
              # data: { controller: "search-box" },
              html: { id: "filter-form",
                      class: "w-full overflow-x-auto" } do |f| %>

  <div style="display:flex;">
    <div class="col-auto">
    <!-- Month -->
      <%= f.label :month_and_year, "Month Submitted",
                  class: "text-sm font-medium text-gray-700 mb-1" %>
      <%= f.select :month_and_year, @month_year_options,
                   { include_blank: "All months", selected: params[:month_and_year] },
                   # data: { search_box_target: "select" },
                   class: "w-48 rounded-md border border-gray-300 px-3 py-2 text-gray-800 shadow-sm
                           focus:border-blue-500 focus:ring focus:ring-blue-200 focus:outline-none" %>
    </div>

    <!-- Year -->
    <div class="col-auto">
      <%= f.label :year, "Year",
                  class: "text-sm font-medium text-gray-700 mb-1" %>
      <%= f.select :year, @year_options,
                   { include_blank: "All years", selected: params[:year] },
                   # data: { search_box_target: "select" },
                   class: "w-36 rounded-md border border-gray-300 px-3 py-2 text-gray-800 shadow-sm
                           focus:border-blue-500 focus:ring focus:ring-blue-200 focus:outline-none" %>
    </div>

    <!-- Facilitator -->
    <div class="col-auto">
      <%= f.label :user_id, "Facilitator",
                  class: "text-sm font-medium text-gray-700 mb-1" %>
      <%= f.collection_select :user_id, @facilitators, :id, :name,
                              { include_blank: "All facilitators", selected: params[:user_id] },
                              # data: { search_box_target: "select" },
                              class: "w-48 rounded-md border border-gray-300 px-3 py-2 text-gray-800 shadow-sm
                                     focus:border-blue-500 focus:ring focus:ring-blue-200 focus:outline-none" %>
    </div>

    <!-- Organization -->
    <div class="col-auto">
      <%= f.label :project_id, "Organization",
                  class: "text-sm font-medium text-gray-700 mb-1" %>
      <%= f.collection_select :project_id, @projects, :id, :name,
                              { include_blank: "All organizations", selected: params[:project_id] },
                              # data: { search_box_target: "select" },
                              class: "w-96 rounded-md border border-gray-300 px-3 py-2 text-gray-800 shadow-sm
                                     focus:border-blue-500 focus:ring focus:ring-blue-200 focus:outline-none" %>
    </div>

  </div>

<% end %>


<script>
    document.addEventListener("turbo:load", () => {
        // Find the first (or specific) filter form on the page
        const filterForm = document.querySelector("form[action='/workshop_logs']");
        filterForm.querySelectorAll("select").forEach(select => {
            select.addEventListener("change", () => {
                filterForm.requestSubmit(); // more Turbo-friendly than form.submit()
            });
        });
    });
</script>
